<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}EMS Home{% endblock %}</title>
    <style>
        body { margin: 0; font-family: "Segoe UI", Arial, sans-serif; background: #f5f6f8; color: #1f2430; }
        header { background: #1f2a44; color: #fff; padding: 1rem 1.5rem; display: flex; justify-content: space-between; align-items: center; }
        header h1 { margin: 0; font-size: 1.1rem; }
        .shell { display: flex; min-height: calc(100vh - 64px); }
        nav { width: 220px; background: #fff; border-right: 1px solid #e5e7eb; padding: 1rem; }
        nav a { display: block; color: #1f2430; text-decoration: none; padding: 0.5rem 0.75rem; border-radius: 6px; margin-bottom: 0.25rem; }
        nav a:hover { background: #eef2ff; }
        main { flex: 1; padding: 1.5rem 2rem; }
        .card { background: #fff; border-radius: 10px; padding: 1rem 1.25rem; box-shadow: 0 1px 3px rgba(0,0,0,0.06); margin-bottom: 1rem; }
        .flash { margin-bottom: 1rem; padding: 0.75rem 1rem; border-radius: 6px; }
        .flash.error { background: #fee2e2; color: #991b1b; }
        .flash.success { background: #dcfce7; color: #166534; }
        .flash.info { background: #e0f2fe; color: #075985; }
        table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
        th, td { text-align: left; padding: 0.5rem 0.75rem; border-bottom: 1px solid #e5e7eb; }
        tr.clickable:hover { background: #f8fafc; cursor: pointer; }
        form.inline { display: inline; }
        .actions a { margin-right: 0.5rem; }
        label { display: block; font-weight: 600; margin-top: 0.75rem; }
        input, select { padding: 0.5rem; width: 100%; max-width: 320px; margin-top: 0.25rem; }
        button, .button-link { margin-top: 1rem; padding: 0.6rem 1.1rem; background: #1f2a44; color: #fff; border: none; border-radius: 6px; cursor: pointer; text-decoration:none; display:inline-block; }
        .logout-button { background: transparent; border: 1px solid #cbd5f5; color: #fff; margin: 0; padding: 0.4rem 0.8rem; }
        .filters { display:flex; gap: 0.75rem; align-items: end; flex-wrap:wrap; }
        .filters > div { min-width: 180px; }
    </style>
</head>
<body>
<header>
    <h1>EMS Home</h1>
    <div>
        <span>{{ current_user.username }} ({{ current_user.role }})</span>
        <form action="{{ url_for('auth.logout') }}" method="post" class="inline">
            <button type="submit" class="logout-button">Logout</button>
        </form>
    </div>
</header>
<div class="shell">
    <nav>
        <a href="{{ url_for('main.home') }}">Home</a>
        <a href="{{ url_for('databases.tasks_list') }}">Tasks</a>
        <a href="{{ url_for('databases.projects_list') }}">Projects</a>
        <a href="{{ url_for('databases.companies_list') }}">Companies</a>
        {% if current_user.role == 'Admin' %}
            <a href="{{ url_for('admin.users_list') }}">Admin</a>
        {% endif %}
    </nav>
    <main>
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash {{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}
    </main>
</div>
</body>
</html>
